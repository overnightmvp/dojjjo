fcdv<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔥 OMVP Home Services - Project Dashboard</title>
    <style>
        :root {
            --primary: #dc2626;
            --success: #059669;
            --warning: #f59e0b;
            --danger: #dc2626;
            --dark: #111827;
            --light: #f9fafb;
            --border: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--dark);
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 800;
        }

        .header p {
            opacity: 0.8;
            margin-top: 5px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
        }

        .card h2 {
            margin-bottom: 15px;
            color: var(--dark);
            font-size: 1.3rem;
        }

        .status-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .status-ready { background: #dcfce7; color: #166534; }
        .status-inprogress { background: #fef3c7; color: #92400e; }
        .status-blocked { background: #fee2e2; color: #991b1b; }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-value {
            font-weight: 700;
            color: var(--primary);
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid transparent;
            min-width: 80px;
            display: inline-block;
            transition: all 0.2s ease;
        }

        .metric-value:hover {
            background: #f0f9ff;
            border-color: var(--primary);
        }

        .metric-value input {
            border: none;
            background: transparent;
            color: var(--primary);
            font-weight: 700;
            font-size: inherit;
            width: 100%;
            outline: none;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .link-btn {
            display: block;
            padding: 12px 16px;
            background: var(--primary);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s ease;
        }

        .link-btn:hover {
            background: #b91c1c;
            transform: translateY(-1px);
        }

        .link-btn.secondary {
            background: var(--border);
            color: var(--dark);
        }

        .link-btn.secondary:hover {
            background: #d1d5db;
        }

        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: move;
            transition: all 0.2s ease;
            position: relative;
        }

        .task-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }

        .task-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .task-item.completed {
            opacity: 0.6;
            background: #f8f9fa;
        }

        .task-checkbox {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .task-text {
            flex-grow: 1;
            margin: 0 12px;
            cursor: text;
            min-height: 20px;
            padding: 4px;
            border: 1px solid transparent;
            border-radius: 4px;
            outline: none;
        }

        .task-text:hover {
            border-color: var(--border);
        }

        .task-text:focus {
            border-color: var(--primary);
            background: white;
        }

        .task-text.completed {
            text-decoration: line-through;
        }

        .task-priority {
            font-size: 0.8rem;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 600;
        }

        .priority-high { background: #fee2e2; color: #991b1b; }
        .priority-medium { background: #fef3c7; color: #92400e; }
        .priority-low { background: #dcfce7; color: #166534; }

        .notes-section {
            grid-column: 1 / -1;
        }

        .notes-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            resize: vertical;
            line-height: 1.5;
        }

        .notes-controls {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .notes-btn {
            padding: 6px 12px;
            background: var(--light);
            border: 1px solid var(--border);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .notes-btn:hover {
            background: var(--border);
        }

        .auto-save-indicator {
            color: var(--success);
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .auto-save-indicator.show {
            opacity: 1;
        }

        .health-status {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            background: white;
            min-width: 140px;
            transition: all 0.2s ease;
        }

        .health-status:hover {
            border-color: var(--primary);
        }

        .health-status:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.1);
        }

        .system-health-summary {
            margin-top: 15px;
        }

        .status-ready { border-left-color: var(--success) !important; }
        .status-warning { border-left-color: var(--warning) !important; }
        .status-error { border-left-color: var(--danger) !important; }
        .status-progress { border-left-color: #3b82f6 !important; }
        .status-critical { border-left-color: #dc2626 !important; background: #fef2f2 !important; }

        .last-updated {
            text-align: center;
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }

        .data-controls {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .data-btn {
            padding: 8px 16px;
            margin: 0 4px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .data-btn:hover {
            background: #b91c1c;
        }

        .data-btn.secondary {
            background: var(--border);
            color: var(--dark);
        }

        .data-btn.secondary:hover {
            background: #d1d5db;
        }

        .add-task-form {
            display: none;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 12px;
        }

        .add-task-form.show {
            display: block;
        }

        .add-task-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .form-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .form-row select {
            padding: 6px 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.8rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .quick-links {
                grid-template-columns: 1fr;
            }

            .notes-controls {
                justify-content: center;
            }

            .data-controls {
                padding: 15px 10px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>🔥 OMVP Home Services</h1>
            <p>Phoenix Emergency HVAC Lead Generation - Project Command Center</p>
        </div>
    </header>

    <div class="container">
        <!-- Project Status -->
        <div class="grid">
            <div class="card">
                <h2>📊 Project Status</h2>
                <div class="status-indicator status-ready">90-MIN SPRINT COMPLETE</div>
                
                <div class="metric">
                    <span>Current Phase</span>
                    <span class="metric-value">Contractor Outreach</span>
                </div>
                <div class="metric">
                    <span>Next Milestone</span>
                    <span class="metric-value">First Contract Signed</span>
                </div>
                <div class="metric">
                    <span>Target Launch</span>
                    <span class="metric-value">This Week</span>
                </div>
                <div class="metric">
                    <span>Revenue Target (Month 1)</span>
                    <span class="metric-value">$7,500-15,000</span>
                </div>
            </div>

            <div class="card">
                <h2>🎯 Key Metrics</h2>
                <div class="metric">
                    <span>Contractors Contacted</span>
                    <span class="metric-value" data-metric="contractorsContacted" onclick="editMetric(this)">0 / 10</span>
                </div>
                <div class="metric">
                    <span>Demo Calls Scheduled</span>
                    <span class="metric-value" data-metric="demoCalls" onclick="editMetric(this)">0 / 3</span>
                </div>
                <div class="metric">
                    <span>Contracts Signed</span>
                    <span class="metric-value" data-metric="contractsSigned" onclick="editMetric(this)">0 / 1</span>
                </div>
                <div class="metric">
                    <span>Leads Generated</span>
                    <span class="metric-value" data-metric="leadsGenerated" onclick="editMetric(this)">0 / 20</span>
                </div>
                <div class="metric">
                    <span>Monthly Revenue</span>
                    <span class="metric-value" data-metric="monthlyRevenue" onclick="editMetric(this)">$0 / $7,500</span>
                </div>
            </div>
        </div>

        <!-- Quick Access Links -->
        <div class="grid">
            <div class="card">
                <h2>⚡ Quick Access - Core Files</h2>
                <div class="quick-links">
                    <a href="landing-page/index.html" class="link-btn">🏠 Landing Page</a>
                    <a href="outreach/contractor-research.md" class="link-btn">👥 Contractor List</a>
                    <a href="outreach/email-templates.md" class="link-btn">📧 Email Templates</a>
                    <a href="docs/next-steps-roadmap.md" class="link-btn">🗺️ Action Plan</a>
                </div>
            </div>

            <div class="card">
                <h2>🔧 External Tools</h2>
                <div class="quick-links">
                    <a href="https://analytics.google.com" class="link-btn secondary" target="_blank">📊 Analytics</a>
                    <a href="https://business.facebook.com" class="link-btn secondary" target="_blank">📱 FB Ads</a>
                    <a href="https://formspree.io" class="link-btn secondary" target="_blank">📝 Forms</a>
                    <a href="https://voice.google.com" class="link-btn secondary" target="_blank">📞 Voice</a>
                </div>
            </div>
        </div>

        <!-- Today's Workflow -->
        <div class="grid">
            <div class="card">
                <h2>📋 Today's Priority Tasks</h2>
                
                <div class="add-task-form" id="addTaskForm">
                    <input type="text" class="add-task-input" id="newTaskText" placeholder="Enter new task...">
                    <div class="form-row">
                        <select id="newTaskPriority">
                            <option value="high">High Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="low">Low Priority</option>
                        </select>
                        <button class="data-btn" onclick="addTask()">Add Task</button>
                        <button class="data-btn secondary" onclick="cancelAddTask()">Cancel</button>
                    </div>
                </div>
                
                <div style="margin-bottom: 12px; text-align: right;">
                    <button class="data-btn secondary" onclick="showAddTaskForm()">+ Add Task</button>
                </div>
                
                <div class="task-list" id="taskList">
                    <div class="task-item" draggable="true" data-priority="high">
                        <input type="checkbox" class="task-checkbox">
                        <div class="task-text" contenteditable="true">Test landing page on mobile device</div>
                        <span class="task-priority priority-high">HIGH</span>
                        <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
                    </div>
                    <div class="task-item" draggable="true" data-priority="high">
                        <input type="checkbox" class="task-checkbox">
                        <div class="task-text" contenteditable="true">Set up Google Voice business number</div>
                        <span class="task-priority priority-high">HIGH</span>
                        <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
                    </div>
                    <div class="task-item" draggable="true" data-priority="high">
                        <input type="checkbox" class="task-checkbox">
                        <div class="task-text" contenteditable="true">Send first contractor outreach email</div>
                        <span class="task-priority priority-high">HIGH</span>
                        <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
                    </div>
                    <div class="task-item" draggable="true" data-priority="medium">
                        <input type="checkbox" class="task-checkbox">
                        <div class="task-text" contenteditable="true">Create Google Analytics account</div>
                        <span class="task-priority priority-medium">MED</span>
                        <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
                    </div>
                    <div class="task-item" draggable="true" data-priority="medium">
                        <input type="checkbox" class="task-checkbox">
                        <div class="task-text" contenteditable="true">Research Facebook Business Manager setup</div>
                        <span class="task-priority priority-medium">MED</span>
                        <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>⚠️ System Health Check</h2>
                <div class="metric">
                    <span>Landing Page</span>
                    <select class="health-status" data-system="landingPage" onchange="updateHealthStatus(this)">
                        <option value="✅ Ready">✅ Ready</option>
                        <option value="⚠️ Needs Setup">⚠️ Needs Setup</option>
                        <option value="❌ Not Setup">❌ Not Setup</option>
                        <option value="🔧 In Progress">🔧 In Progress</option>
                        <option value="🚨 Critical Issue">🚨 Critical Issue</option>
                    </select>
                </div>
                <div class="metric">
                    <span>Contact Form</span>
                    <select class="health-status" data-system="contactForm" onchange="updateHealthStatus(this)">
                        <option value="✅ Ready">✅ Ready</option>
                        <option value="⚠️ Needs Setup" selected>⚠️ Needs Setup</option>
                        <option value="❌ Not Setup">❌ Not Setup</option>
                        <option value="🔧 In Progress">🔧 In Progress</option>
                        <option value="🚨 Critical Issue">🚨 Critical Issue</option>
                    </select>
                </div>
                <div class="metric">
                    <span>Phone System</span>
                    <select class="health-status" data-system="phoneSystem" onchange="updateHealthStatus(this)">
                        <option value="✅ Ready">✅ Ready</option>
                        <option value="⚠️ Needs Setup" selected>⚠️ Needs Setup</option>
                        <option value="❌ Not Setup">❌ Not Setup</option>
                        <option value="🔧 In Progress">🔧 In Progress</option>
                        <option value="🚨 Critical Issue">🚨 Critical Issue</option>
                    </select>
                </div>
                <div class="metric">
                    <span>Analytics</span>
                    <select class="health-status" data-system="analytics" onchange="updateHealthStatus(this)">
                        <option value="✅ Ready">✅ Ready</option>
                        <option value="⚠️ Needs Setup">⚠️ Needs Setup</option>
                        <option value="❌ Not Setup" selected>❌ Not Setup</option>
                        <option value="🔧 In Progress">🔧 In Progress</option>
                        <option value="🚨 Critical Issue">🚨 Critical Issue</option>
                    </select>
                </div>
                <div class="metric">
                    <span>Facebook Ads</span>
                    <select class="health-status" data-system="facebookAds" onchange="updateHealthStatus(this)">
                        <option value="✅ Ready">✅ Ready</option>
                        <option value="⚠️ Needs Setup">⚠️ Needs Setup</option>
                        <option value="❌ Not Setup" selected>❌ Not Setup</option>
                        <option value="🔧 In Progress">🔧 In Progress</option>
                        <option value="🚨 Critical Issue">🚨 Critical Issue</option>
                    </select>
                </div>
                
                <div class="system-health-summary" id="healthSummary">
                    <div style="margin-top: 15px; padding: 12px; background: #f8f9fa; border-radius: 6px; border-left: 4px solid var(--warning);">
                        <strong>System Status:</strong> <span id="overallStatus">⚠️ Needs Attention</span>
                        <div style="font-size: 0.9rem; margin-top: 5px; color: #6b7280;">
                            <span id="statusDetails">3 systems need setup</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Critical Info -->
        <div class="grid">
            <div class="card">
                <h2>📞 Emergency Contacts & Info</h2>
                <div class="metric">
                    <span>Target City</span>
                    <span class="metric-value">Phoenix, AZ</span>
                </div>
                <div class="metric">
                    <span>Lead Price</span>
                    <span class="metric-value">$75 per qualified lead</span>
                </div>
                <div class="metric">
                    <span>Target CPA</span>
                    <span class="metric-value">Under $40</span>
                </div>
                <div class="metric">
                    <span>Peak Season</span>
                    <span class="metric-value">May - September</span>
                </div>
                <div class="metric">
                    <span>Business Phone</span>
                    <span class="metric-value">📞 Setup Google Voice</span>
                </div>
            </div>

            <div class="card notes-section">
                <h2>📝 Quick Notes & Decisions</h2>
                
                <div class="notes-controls">
                    <button class="notes-btn" onclick="formatText('bold')"><strong>B</strong></button>
                    <button class="notes-btn" onclick="formatText('italic')"><em>I</em></button>
                    <button class="notes-btn" onclick="insertText('• ')">• List</button>
                    <button class="notes-btn" onclick="insertText('\n---\n')">Divider</button>
                    <button class="notes-btn" onclick="insertTimestamp()">📅 Date</button>
                    <button class="notes-btn" onclick="exportNotes()">📤 Export</button>
                    <span class="auto-save-indicator" id="autoSaveIndicator">✓ Saved</span>
                </div>
                
                <textarea 
                    class="notes-textarea" 
                    placeholder="Capture quick notes, decisions, and important updates here...\n\nTips:\n- Use the toolbar for formatting\n- Notes auto-save every 3 seconds\n- Export to backup your notes"
                    id="projectNotes"
                ></textarea>
                
                <small style="color: #6b7280; margin-top: 8px; display: block;">
                    Auto-saves every 3 seconds • Stored locally in browser • Use Export for backup
                </small>
            </div>
        </div>

        <!-- Data Management Controls -->
        <div class="data-controls">
            <h3 style="margin-bottom: 15px;">💾 Data Management</h3>
            <button class="data-btn" onclick="exportData()">📤 Export Project Data</button>
            <button class="data-btn secondary" onclick="document.getElementById('importFile').click()">📥 Import Data</button>
            <button class="data-btn secondary" onclick="resetData()">🔄 Reset Dashboard</button>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
            <p style="margin-top: 10px; font-size: 0.9rem; color: #6b7280;">
                All data is stored locally in your browser. Export regularly for backup.
            </p>
        </div>

        <div class="last-updated">
            <p>🚀 Dashboard created: <span id="currentDate"></span></p>
            <p><strong>Last updated:</strong> <span id="lastUpdated">Now</span></p>
            <p><strong>Next Review:</strong> End of this week</p>
        </div>
    </div>

    <script>
        // Enhanced Dashboard JavaScript with Full Interactivity
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            loadAllData();
            setupEventListeners();
            console.log('🔥 Interactive OMVP Dashboard Loaded - Focus on execution!');
        });
        
        // Data storage keys
        const STORAGE_KEYS = {
            tasks: 'omvp-tasks',
            metrics: 'omvp-metrics', 
            notes: 'omvp-notes',
            projectData: 'omvp-project-data'
        };
        
        // Auto-save timer
        let autoSaveTimer;
        
        function initializeDashboard() {
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString();
            updateLastUpdated();
        }
        
        function updateLastUpdated() {
            document.getElementById('lastUpdated').textContent = new Date().toLocaleTimeString();
        }
        
        // ====================
        // TASK MANAGEMENT
        // ====================
        
        function loadAllData() {
            loadTasks();
            loadMetrics();
            loadNotes();
            loadSystemHealth();
        }
        
        function loadTasks() {
            const savedTasks = localStorage.getItem(STORAGE_KEYS.tasks);
            if (savedTasks) {
                const tasks = JSON.parse(savedTasks);
                renderTasks(tasks);
            } else {
                // Initialize with default tasks if none exist
                saveTasks();
            }
        }
        
        function saveTasks() {
            const taskElements = document.querySelectorAll('.task-item');
            const tasks = Array.from(taskElements).map((task, index) => {
                const checkbox = task.querySelector('.task-checkbox');
                const textElement = task.querySelector('.task-text');
                const priorityElement = task.querySelector('.task-priority');
                
                return {
                    id: index,
                    text: textElement.textContent.trim(),
                    completed: checkbox.checked,
                    priority: task.dataset.priority || 'medium'
                };
            });
            
            localStorage.setItem(STORAGE_KEYS.tasks, JSON.stringify(tasks));
            updateLastUpdated();
        }
        
        function renderTasks(tasks) {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            tasks.forEach((task, index) => {
                const taskElement = createTaskElement(task, index);
                taskList.appendChild(taskElement);
            });
        }
        
        function createTaskElement(task, index) {
            const taskDiv = document.createElement('div');
            taskDiv.className = `task-item ${task.completed ? 'completed' : ''}`;
            taskDiv.draggable = true;
            taskDiv.dataset.priority = task.priority;
            
            const priorityClass = `priority-${task.priority}`;
            const priorityText = task.priority.toUpperCase();
            
            taskDiv.innerHTML = `
                <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                <div class="task-text ${task.completed ? 'completed' : ''}" contenteditable="true">${task.text}</div>
                <span class="task-priority ${priorityClass}">${priorityText}</span>
                <button class="data-btn secondary" style="padding: 4px 8px; font-size: 0.7rem; margin-left: 8px;" onclick="deleteTask(this)">×</button>
            `;
            
            // Add event listeners
            const checkbox = taskDiv.querySelector('.task-checkbox');
            const textElement = taskDiv.querySelector('.task-text');
            
            checkbox.addEventListener('change', function() {
                task.completed = this.checked;
                taskDiv.classList.toggle('completed', this.checked);
                textElement.classList.toggle('completed', this.checked);
                saveTasks();
            });
            
            textElement.addEventListener('blur', function() {
                task.text = this.textContent.trim();
                saveTasks();
            });
            
            // Drag and drop
            taskDiv.addEventListener('dragstart', handleDragStart);
            taskDiv.addEventListener('dragover', handleDragOver);
            taskDiv.addEventListener('drop', handleDrop);
            taskDiv.addEventListener('dragend', handleDragEnd);
            
            return taskDiv;
        }
        
        function showAddTaskForm() {
            document.getElementById('addTaskForm').classList.add('show');
            document.getElementById('newTaskText').focus();
        }
        
        function cancelAddTask() {
            document.getElementById('addTaskForm').classList.remove('show');
            document.getElementById('newTaskText').value = '';
        }
        
        function addTask() {
            const textInput = document.getElementById('newTaskText');
            const prioritySelect = document.getElementById('newTaskPriority');
            
            const text = textInput.value.trim();
            if (!text) return;
            
            const newTask = {
                id: Date.now(),
                text: text,
                completed: false,
                priority: prioritySelect.value
            };
            
            const taskList = document.getElementById('taskList');
            const taskElement = createTaskElement(newTask, taskList.children.length);
            taskList.appendChild(taskElement);
            
            saveTasks();
            cancelAddTask();
        }
        
        function deleteTask(button) {
            if (confirm('Delete this task?')) {
                button.closest('.task-item').remove();
                saveTasks();
            }
        }
        
        // Drag and drop functionality
        let draggedElement = null;
        
        function handleDragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }
        
        function handleDragOver(e) {
            if (e.preventDefault) e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }
        
        function handleDrop(e) {
            if (e.stopPropagation) e.stopPropagation();
            
            if (draggedElement !== this) {
                const taskList = document.getElementById('taskList');
                const allTasks = Array.from(taskList.children);
                const draggedIndex = allTasks.indexOf(draggedElement);
                const targetIndex = allTasks.indexOf(this);
                
                if (draggedIndex < targetIndex) {
                    taskList.insertBefore(draggedElement, this.nextSibling);
                } else {
                    taskList.insertBefore(draggedElement, this);
                }
                
                saveTasks();
            }
            
            return false;
        }
        
        function handleDragEnd(e) {
            this.classList.remove('dragging');
            draggedElement = null;
        }
        
        // ====================
        // METRICS MANAGEMENT
        // ====================
        
        function loadMetrics() {
            const savedMetrics = localStorage.getItem(STORAGE_KEYS.metrics);
            if (savedMetrics) {
                const metrics = JSON.parse(savedMetrics);
                Object.keys(metrics).forEach(key => {
                    const element = document.querySelector(`[data-metric="${key}"]`);
                    if (element) {
                        element.textContent = metrics[key];
                    }
                });
            }
        }
        
        function editMetric(element) {
            const currentValue = element.textContent;
            const metricKey = element.dataset.metric;
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = currentValue;
            input.style.width = '100%';
            
            element.innerHTML = '';
            element.appendChild(input);
            input.focus();
            input.select();
            
            function saveMetric() {
                const newValue = input.value.trim() || currentValue;
                element.textContent = newValue;
                
                // Save to localStorage
                const savedMetrics = JSON.parse(localStorage.getItem(STORAGE_KEYS.metrics) || '{}');
                savedMetrics[metricKey] = newValue;
                localStorage.setItem(STORAGE_KEYS.metrics, JSON.stringify(savedMetrics));
                updateLastUpdated();
            }
            
            input.addEventListener('blur', saveMetric);
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            });
        }
        
        // ====================
        // NOTES MANAGEMENT
        // ====================
        
        function loadNotes() {
            const savedNotes = localStorage.getItem(STORAGE_KEYS.notes);
            const notesTextarea = document.getElementById('projectNotes');
            
            if (savedNotes) {
                notesTextarea.value = savedNotes;
            }
            
            // Auto-save notes
            notesTextarea.addEventListener('input', function() {
                clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    localStorage.setItem(STORAGE_KEYS.notes, this.value);
                    showAutoSaveIndicator();
                    updateLastUpdated();
                }, 3000);
            });
        }
        
        function showAutoSaveIndicator() {
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }
        
        function formatText(command) {
            const textarea = document.getElementById('projectNotes');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            
            let formattedText = selectedText;
            if (command === 'bold') {
                formattedText = `**${selectedText}**`;
            } else if (command === 'italic') {
                formattedText = `*${selectedText}*`;
            }
            
            textarea.value = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
            textarea.focus();
            textarea.setSelectionRange(start, start + formattedText.length);
        }
        
        function insertText(text) {
            const textarea = document.getElementById('projectNotes');
            const start = textarea.selectionStart;
            textarea.value = textarea.value.substring(0, start) + text + textarea.value.substring(start);
            textarea.focus();
            textarea.setSelectionRange(start + text.length, start + text.length);
        }
        
        function insertTimestamp() {
            const timestamp = new Date().toLocaleString();
            insertText(`\n\n**${timestamp}**\n`);
        }
        
        function exportNotes() {
            const notes = document.getElementById('projectNotes').value;
            const blob = new Blob([notes], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `omvp-notes-${new Date().toISOString().split('T')[0]}.md`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // ====================
        // SYSTEM HEALTH MANAGEMENT
        // ====================
        
        function loadSystemHealth() {
            const savedHealth = localStorage.getItem(STORAGE_KEYS.systemHealth || 'omvp-system-health');
            if (savedHealth) {
                const healthData = JSON.parse(savedHealth);
                Object.keys(healthData).forEach(system => {
                    const dropdown = document.querySelector(`[data-system="${system}"]`);
                    if (dropdown) {
                        dropdown.value = healthData[system];
                    }
                });
            }
            updateSystemHealthSummary();
        }
        
        function updateHealthStatus(dropdown) {
            const system = dropdown.dataset.system;
            const status = dropdown.value;
            
            // Save to localStorage
            const savedHealth = JSON.parse(localStorage.getItem('omvp-system-health') || '{}');
            savedHealth[system] = status;
            localStorage.setItem('omvp-system-health', JSON.stringify(savedHealth));
            
            updateSystemHealthSummary();
            updateLastUpdated();
        }
        
        function updateSystemHealthSummary() {
            const healthDropdowns = document.querySelectorAll('.health-status');
            const summaryDiv = document.getElementById('healthSummary').querySelector('div');
            const overallStatus = document.getElementById('overallStatus');
            const statusDetails = document.getElementById('statusDetails');
            
            let readyCount = 0;
            let needsSetupCount = 0;
            let notSetupCount = 0;
            let inProgressCount = 0;
            let criticalCount = 0;
            
            healthDropdowns.forEach(dropdown => {
                const status = dropdown.value;
                if (status.includes('Ready')) readyCount++;
                else if (status.includes('Needs Setup')) needsSetupCount++;
                else if (status.includes('Not Setup')) notSetupCount++;
                else if (status.includes('In Progress')) inProgressCount++;
                else if (status.includes('Critical')) criticalCount++;
            });
            
            const total = healthDropdowns.length;
            
            // Determine overall status
            let overallText, statusClass, detailsText;
            
            if (criticalCount > 0) {
                overallText = '🚨 Critical Issues';
                statusClass = 'status-critical';
                detailsText = `${criticalCount} critical issue${criticalCount > 1 ? 's' : ''} need immediate attention`;
            } else if (readyCount === total) {
                overallText = '✅ All Systems Operational';
                statusClass = 'status-ready';
                detailsText = 'All systems are ready and functioning';
            } else if (inProgressCount > 0) {
                overallText = '🔧 Setup In Progress';
                statusClass = 'status-progress';
                detailsText = `${inProgressCount} system${inProgressCount > 1 ? 's' : ''} being configured`;
            } else if (needsSetupCount > 0 || notSetupCount > 0) {
                overallText = '⚠️ Needs Attention';
                statusClass = 'status-warning';
                detailsText = `${needsSetupCount + notSetupCount} system${needsSetupCount + notSetupCount > 1 ? 's' : ''} need setup`;
            }
            
            overallStatus.textContent = overallText;
            statusDetails.textContent = detailsText;
            
            // Update summary styling
            summaryDiv.className = '';
            summaryDiv.classList.add(statusClass);
        }
        
        // ====================
        // DATA MANAGEMENT
        // ====================
        
        function exportData() {
            const projectData = {
                tasks: JSON.parse(localStorage.getItem(STORAGE_KEYS.tasks) || '[]'),
                metrics: JSON.parse(localStorage.getItem(STORAGE_KEYS.metrics) || '{}'),
                notes: localStorage.getItem(STORAGE_KEYS.notes) || '',
                systemHealth: JSON.parse(localStorage.getItem('omvp-system-health') || '{}'),
                exported: new Date().toISOString(),
                projectName: 'OMVP Home Services'
            };
            
            const blob = new Blob([JSON.stringify(projectData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `omvp-project-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const projectData = JSON.parse(e.target.result);
                    
                    if (confirm('This will replace all current data. Continue?')) {
                        if (projectData.tasks) {
                            localStorage.setItem(STORAGE_KEYS.tasks, JSON.stringify(projectData.tasks));
                        }
                        if (projectData.metrics) {
                            localStorage.setItem(STORAGE_KEYS.metrics, JSON.stringify(projectData.metrics));
                        }
                        if (projectData.notes) {
                            localStorage.setItem(STORAGE_KEYS.notes, projectData.notes);
                        }
                        if (projectData.systemHealth) {
                            localStorage.setItem('omvp-system-health', JSON.stringify(projectData.systemHealth));
                        }
                        
                        location.reload();
                    }
                } catch (error) {
                    alert('Invalid file format');
                }
            };
            reader.readAsText(file);
        }
        
        function resetData() {
            if (confirm('This will delete all dashboard data. Are you sure?')) {
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                localStorage.removeItem('omvp-system-health');
                location.reload();
            }
        }
        
        function setupEventListeners() {
            // Enter key for add task
            document.getElementById('newTaskText').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTask();
                }
            });
        }
        
        // Global functions for HTML onclick handlers
        window.editMetric = editMetric;
        window.showAddTaskForm = showAddTaskForm;
        window.cancelAddTask = cancelAddTask;
        window.addTask = addTask;
        window.deleteTask = deleteTask;
        window.formatText = formatText;
        window.insertText = insertText;
        window.insertTimestamp = insertTimestamp;
        window.exportNotes = exportNotes;
        window.exportData = exportData;
        window.importData = importData;
        window.resetData = resetData;
        window.updateHealthStatus = updateHealthStatus;
    </script>
</body>
</html>